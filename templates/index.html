<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meme Generator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-image"></i> Meme Generator</h1>
            <p class="subtitle">Upload an image and add text to create your own meme!</p>
        </header>

        <main>
            <div class="generator-container">
                <div class="form-section">
                    <h2><i class="fas fa-edit"></i> Create Your Meme</h2>
                    
                    {% if error %}
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i> {{ error }}
                    </div>
                    {% endif %}
                    
                    <form method="POST" enctype="multipart/form-data" class="meme-form">
                        <div class="form-group">
                            <label for="image"><i class="fas fa-file-image"></i> Choose an Image:</label>
                            <input type="file" id="image" name="image" accept="image/*" required>
                            <small>Supported formats: JPG, PNG, GIF (Max 5MB)</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="top_text"><i class="fas fa-arrow-up"></i> Top Text:</label>
                            <input type="text" id="top_text" name="top_text" value="{{ top_text }}" placeholder="Enter text for the top of the meme">
                        </div>
                        
                        <div class="form-group">
                            <label for="bottom_text"><i class="fas fa-arrow-down"></i> Bottom Text:</label>
                            <input type="text" id="bottom_text" name="bottom_text" value="{{ bottom_text }}" placeholder="Enter text for the bottom of the meme">
                        </div>
                        
                        <button type="submit" class="btn-generate">
                            <i class="fas fa-magic"></i> Generate Meme
                        </button>
                    </form>
                </div>
                
                <div class="preview-section">
                    <h2><i class="fas fa-eye"></i> Preview</h2>
                    
                    {% if meme_image %}
                    <div class="meme-preview">
                        <img src="{{ url_for('view_meme', filename=meme_image) }}" alt="Generated Meme" id="meme-img">
                        
                        <div class="meme-actions">
                            <a href="{{ url_for('download', filename=meme_image) }}" class="btn-download">
                                <i class="fas fa-download"></i> Download Meme
                            </a>
                            <a href="{{ url_for('index') }}" class="btn-new">
                                <i class="fas fa-plus"></i> Create Another
                            </a>
                        </div>
                        
                        <div class="meme-text-display">
                            <div class="meme-text top-text">{{ top_text if top_text else "Top Text Example" }}</div>
                            <div class="meme-text bottom-text">{{ bottom_text if bottom_text else "Bottom Text Example" }}</div>
                        </div>
                    </div>
                    {% else %}
                    <div class="meme-preview placeholder">
                        <img src="{{ url_for('static', filename='images/default-meme.jpg') }}" alt="Meme Example">
                        <p>Your generated meme will appear here</p>
                        <div class="meme-text-display">
                            <div class="meme-text top-text">Top Text Example</div>
                            <div class="meme-text bottom-text">Bottom Text Example</div>
                        </div>
                    </div>
                    {% endif %}
                    
                
                </div>
            </div>
        </main>
        
    </div>
    
    <script>
        // Live preview of text inputs
        document.addEventListener('DOMContentLoaded', function() {
            const topTextInput = document.getElementById('top_text');
            const bottomTextInput = document.getElementById('bottom_text');
            const topTextDisplay = document.querySelector('.top-text');
            const bottomTextDisplay = document.querySelector('.bottom-text');
            
            function updateTextDisplay() {
                if (topTextInput.value) {
                    topTextDisplay.textContent = topTextInput.value;
                } else {
                    topTextDisplay.textContent = "Top Text Example";
                }
                
                if (bottomTextInput.value) {
                    bottomTextDisplay.textContent = bottomTextInput.value;
                } else {
                    bottomTextDisplay.textContent = "Bottom Text Example";
                }
            }
            
            if (topTextInput && bottomTextInput) {
                topTextInput.addEventListener('input', updateTextDisplay);
                bottomTextInput.addEventListener('input', updateTextDisplay);
            }
            
            // Image preview before upload
            const imageInput = document.getElementById('image');
            const memeImg = document.getElementById('meme-img');
            const placeholderImg = document.querySelector('.placeholder img');
            
            imageInput.addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        if (memeImg) {
                            memeImg.src = e.target.result;
                        } else if (placeholderImg) {
                            placeholderImg.src = e.target.result;
                        }
                    };
                    
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
        });
    </script>
</body>
</html>